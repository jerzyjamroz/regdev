#include <string.h>#include <stdio.h>#include "regDev.h"#include "test_regDev.h"#define BUFLEN 32#define ZERO      "@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@"#define PATTERN   "12345678ABCDEFGHabcdefghSTUVWXYZ"#define MASK      "awqjh256hjl2cut8pq3498tuz31c4tl2"static char src[BUFLEN] = PATTERN;static char dst[BUFLEN] = ZERO;static char exp[BUFLEN];static char msk[BUFLEN] = MASK;static int expect(const char* str){    int i;    if (memcmp(dst, str, BUFLEN) != 0)    {        printf(" " FAILED ".\nexpected: ");        for (i=0; i<BUFLEN; i++) {            printf("%c", str[i]);        }        printf("\nfound:    ");        for (i=0; i<BUFLEN; i++) {            printf("%c", dst[i]);        }        printf("\n");        errorcount++;        return -1;    }    printf(" " PASSED ".\n");    return 0;} int test_regDevCopy(){    int i;        for (i=0;i<32;i++)    {        printf("regDevCopy(%i,0,src,dst,NULL,0)", i); fflush(stdout);        regDevCopy(i,0,src,dst,NULL,0);        expect(ZERO);                printf("regDevCopy(0,%i,src,dst,NULL,0)", i); fflush(stdout);        regDevCopy(0,i,src,dst,NULL,0);        expect(ZERO);                printf("regDevCopy(%i,0,src,dst,msk,0)", i); fflush(stdout);        regDevCopy(i,0,src,dst,msk,0);        expect(ZERO);                printf("regDevCopy(0,%i,src,dst,msk,0)", i); fflush(stdout);        regDevCopy(0,i,src,dst,msk,0);        expect(ZERO);                printf("regDevCopy(%i,0,src,dst,NULL,1)", i); fflush(stdout);        regDevCopy(i,0,src,dst,NULL,1);        expect(ZERO);                printf("regDevCopy(0,%i,src,dst,NULL,1)", i); fflush(stdout);        regDevCopy(0,i,src,dst,NULL,1);        expect(ZERO);                printf("regDevCopy(%i,0,src,dst,msk,1)", i); fflush(stdout);        regDevCopy(i,0,src,dst,msk,1);        expect(ZERO);                printf("regDevCopy(0,%i,src,dst,msk,1)", i); fflush(stdout);        regDevCopy(0,i,src,dst,msk,1);        expect(ZERO);    }    for (i=1;i<=BUFLEN;i++)    {        int n = BUFLEN / i;        int j,k;                memcpy(dst,ZERO,BUFLEN);        memcpy(exp,ZERO,BUFLEN);        memcpy(exp,src,i*n);                printf("regDevCopy(%i,%i,src,dst,NULL,0)", i, n); fflush(stdout);        regDevCopy(i,n,src,dst,NULL,0);        expect(exp);                memcpy(dst,ZERO,BUFLEN);        memcpy(exp,ZERO,BUFLEN);        for (j=0; j<n; j++) for (k=0; k<i; k++)            exp[j*i+k]=src[j*i+i-k-1];        printf("regDevCopy(%i,%i,src,dst,NULL,1)", i, n); fflush(stdout);        regDevCopy(i,n,src,dst,NULL,1);        expect(exp);        memcpy(dst,ZERO,BUFLEN);        memcpy(exp,ZERO,BUFLEN);        for (j=0; j<n; j++) for (k=0; k<i; k++)            exp[j*i+k]=(dst[j*i+k]&~msk[k])|(src[j*i+k]&msk[k]);                printf("regDevCopy(%i,%i,src,dst,msk,0)", i, n); fflush(stdout);        regDevCopy(i,n,src,dst,msk,0);        expect(exp);                memcpy(dst,ZERO,BUFLEN);        memcpy(exp,ZERO,BUFLEN);        for (j=0; j<n; j++) for (k=0; k<i; k++)            exp[j*i+k]=(dst[j*i+k]&~msk[i-k-1])|(src[j*i+i-k-1]&msk[i-k-1]);        printf("regDevCopy(%i,%i,src,dst,msk,1)", i, n); fflush(stdout);        regDevCopy(i,n,src,dst,msk,1);        expect(exp);            }    return 0;}